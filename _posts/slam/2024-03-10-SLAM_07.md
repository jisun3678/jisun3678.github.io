---
layout: post
image: /assets/images/blog/post-5.jpg
title : "SLAM 7강 (Kalman Filter & EKF) 요약"
category :
    - SLAM
tag :
    - SLAM
toc : true
toc_sticky: true
comments: true
---


## 0. Today's Goal  

- Kalman Filter의 정의 및 가정  
- Kalman Filter의 증명과 동작 원리  
- EKF(Extended Kalman Filter)의 개념 및 확장  
- 주요 차이점과 응용  

---

## 1. 강의 및 강의 자료  

### 강의 정보  
- [Kalman Filter & EKF (Cyrill Stachniss)](https://youtu.be/E-6paM_Iwfc)  
- [SLAM DUNK Season 2 - Kalman Filter & EKF](https://youtu.be/lKuV6fAvuoc)  
- 강의 자료 PDF: [다운로드](https://drive.google.com/file/d/1pkArsis-DMdApgC7DFHNwlAJNQ3TEffo/view?usp=sharing)

---

## 2. Kalman Filter란?  

Kalman Filter는 **Bayes Filter**의 한 종류로, 두 가지 주요 가정을 따릅니다:  
1. 모든 확률 분포는 **가우시안 분포**를 가진다.  
2. 모델은 **선형 시스템**이다.  

이 필터는 로봇의 상태를 추정하기 위해 **Prediction**과 **Correction** 단계를 통해 Recursive하게 동작합니다.  

<p align="center"><img src="https://user-images.githubusercontent.com/41863759/157821571-c6de01c3-2000-4e62-9462-10c4749b68b9.png" width="450"></p>  

Kalman Filter는 Prediction과 Correction 단계를 통해 로봇의 위치와 같은 상태를 지속적으로 업데이트하며, 관찰값과 예측값의 Weighted Sum을 계산하여 최적의 상태를 추정합니다.

---

## 3. Kalman Filter의 가정 및 증명  

### 가정  

Kalman Filter는 아래의 두 가정을 기반으로 합니다:  
1. **가우시안 분포**: 모든 확률 분포가 가우시안이어야 한다.  
2. **선형 시스템**: 시스템의 모델이 선형이어야 한다.  

이 가정을 증명하기 위해 가우시안 분포의 성질과 선형 모델의 특성을 사용합니다:  
- 가우시안의 곱과 Marginalization은 여전히 가우시안을 유지.  
- 선형 모델의 출력은 입력이 가우시안 분포일 경우 여전히 가우시안.  

---

### Kalman Filter의 동작  

Kalman Filter는 **평균($\mu$)**과 **공분산($\Sigma$)**를 이용해 상태를 추정합니다. 이 두 가지 매개변수만으로 가우시안 분포를 완전히 표현할 수 있습니다.

**Kalman Filter Pseudo Code**:  

<p align="center"><img src="https://user-images.githubusercontent.com/41863759/157849203-609f1fd1-8f4b-4e87-a972-30df0e519409.png" width="550"></p>  

- **Prediction Step**: 이전 상태로부터 현재 상태를 예측합니다.  
- **Correction Step**: 관찰값을 사용하여 예측된 상태를 수정합니다.  
- **Kalman Gain**: Prediction과 Correction 간의 비율을 조정.  

---

## 4. EKF (Extended Kalman Filter)란?  

EKF는 **Kalman Filter를 비선형 모델에 적용**할 수 있도록 확장한 필터입니다.  

### 비선형 시스템의 문제  
- 가우시안 분포를 가진 입력을 비선형 모델에 적용하면 가우시안 분포를 유지할 수 없음.  
- 따라서 **Local Linearization**(1차 테일러 급수 전개)을 통해 선형화합니다.  

<p align="center"><img src="https://user-images.githubusercontent.com/41863759/158010139-af9d318d-f660-4024-a9d6-3efcad7ff4e3.png" width="550"></p>  

EKF의 동작은 Kalman Filter와 유사하지만, 모델을 선형화하기 위해 **Jacobian Matrix**($G_t$, $H_t$)를 사용합니다.  

---

### EKF Pseudo Code  

<p align="center"><img src="https://user-images.githubusercontent.com/41863759/158010260-2d59c9cc-5223-4758-a000-3077f2ced41d.png" width="550"></p>  

EKF의 알고리즘은 Kalman Filter와 매우 유사하지만, 선형화를 위해 Jacobian이 사용됩니다.  

---

### EKF의 한계  

1. **Local Linearization 오차**: 테일러 전개로 인해 모델과 실제 값 간 오차가 발생.  
2. **High Uncertainty 문제**: Input Uncertainty가 클 경우, 선형화 오차가 커질 수 있음.  

---

## 5. Summary  

### Kalman Filter  
- **Bayes Filter**의 가정에 기반한 **Linear Gaussian System**에서 동작.  
- Prediction과 Correction 단계로 상태를 Recursive하게 추정.  

### EKF  
- Kalman Filter를 **비선형 모델**에 확장.  
- Local Linearization으로 선형화.  
- Jacobian을 사용하여 Prediction과 Correction 단계를 수행.  

---

## Reference  

- [[SLAM] Kalman filter and EKF(Extended Kalman Filter)](http://jinyongjeong.github.io/2017/02/14/lec03_kalman_filter_and_EKF/)  
- [Kalman Filter Overview](https://en.wikipedia.org/wiki/Kalman_filter)  
